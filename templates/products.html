{% extends "base.html" %}

{% block title %}å•†å“ä¸€è¦§ - VulnApp{% endblock %}

{% block content %}
<h2>å•†å“ä¸€è¦§</h2>

<!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
<div class="search-box">
    <form method="GET" action="/products">
        <input type="text" name="search" placeholder="å•†å“ã‚’æ¤œç´¢..." value="{{ search_query }}">
        <button type="submit" class="btn">æ¤œç´¢</button>
    </form>


</div>

<!-- ğŸš¨ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è¡¨ç¤ºï¼ˆSQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®ãƒ‡ãƒ¢ï¼‰ -->
{% if error_message %}
<div class="error-box" style="white-space: pre-wrap; font-family: monospace;">
    <strong>âš ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼:</strong>
    {{ error_message }}
</div>
{% endif %}

<!-- ğŸš¨ è„†å¼±æ€§2: XSS (Reflected) -->
{% if search_query and not error_message %}
<div class="search-result">
    <p>æ¤œç´¢çµæœ: "{{ search_query | safe }}"</p> <!-- safeãƒ•ã‚£ãƒ«ã‚¿ã§ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—ã‚’ç„¡åŠ¹åŒ– -->
</div>
{% endif %}

<!-- å•†å“ãƒªã‚¹ãƒˆ -->
<div class="product-grid">
    {% for product in products %}
    <div class="product-card">
        <h3>{{ product.name }}</h3>
        <p class="description">{{ product.description }}</p>
        <p class="price">Â¥{{ "{:,}".format(product.price) }}</p>
        <p class="category">ã‚«ãƒ†ã‚´ãƒª: {{ product.category }}</p>
        <a href="/product/{{ product.id }}" class="btn">è©³ç´°ã‚’è¦‹ã‚‹</a>
    </div>
    {% else %}
    {% if not error_message %}
    <p>å•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</p>
    {% endif %}
    {% endfor %}
</div>

<!-- è„†å¼±æ€§ã®ãƒ’ãƒ³ãƒˆ -->
<div class="hint-box">
    <h4>ğŸ’¡ ãƒ†ã‚¹ãƒˆã®ãƒ’ãƒ³ãƒˆ</h4>
    <ul>
        <li><strong>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³:</strong> <code>' OR '1'='1</code> ã‚’æ¤œç´¢ã—ã¦ã¿ã¦ãã ã•ã„</li>
        <li><strong>SQLã‚¨ãƒ©ãƒ¼ãƒ™ãƒ¼ã‚¹:</strong> <code>'</code> ã ã‘ã‚’å…¥åŠ›ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
        <li><strong>XSS (Reflected):</strong> é€šå¸¸ã®ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢å¾Œã€ãƒ–ãƒ©ã‚¦ã‚¶ã®URLã‚’ç›´æ¥ç·¨é›†ã—ã¦ãã ã•ã„</li>
        <li><strong>ä¾‹:</strong> URLã‚’ <code>?search=&lt;h1&gt;Test&lt;/h1&gt;</code> ã«å¤‰æ›´</li>
    </ul>
</div>
{% endblock %}
