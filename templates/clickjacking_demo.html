{% extends "base.html" %}

{% block title %}ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚°ã®ãƒ‡ãƒ¢{% endblock %}

{% block content %}
<div class="vuln-demo">
    <h2>ğŸ¯ ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚° (Clickjacking) ã®ãƒ‡ãƒ¢</h2>
    
    <div class="warning-box">
        <h3>âš ï¸ è„†å¼±æ€§: ã‚¯ãƒªãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚­ãƒ³ã‚° (UI Redressing)</h3>
        <p>ã“ã®æ©Ÿèƒ½ã¯æ„å›³çš„ã«X-Frame-Optionsãƒ˜ãƒƒãƒ€ãƒ¼ã‚’è¨­å®šã—ã¦ã„ã¾ã›ã‚“ã€‚</p>
        <p>æ”»æ’ƒè€…ã¯é€æ˜ãªiframeã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’é¨™ã—ã€æ„å›³ã—ãªã„ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚</p>
    </div>

    <div class="demo-section">
        <h3>è„†å¼±ãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ä¾‹</h3>
        <p>ä»¥ä¸‹ã®ãƒœã‚¿ãƒ³ã¯ã€X-Frame-OptionsãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ãŸã‚ã€iframeå†…ã«åŸ‹ã‚è¾¼ã¿å¯èƒ½ã§ã™ã€‚</p>
        
        <form method="POST" action="/account/delete" style="margin: 20px 0;">
            <input type="hidden" name="username" value="victim">
            <button type="submit" class="btn" style="background-color: #dc3545; padding: 15px 30px; font-size: 18px;">
                ğŸ—‘ï¸ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤
            </button>
        </form>
        <p class="hint-text">â€» ã“ã®ãƒœã‚¿ãƒ³ã¯å®Ÿéš›ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’å‰Šé™¤ã—ã¾ã›ã‚“ãŒã€è„†å¼±æ€§ã®ãƒ‡ãƒ¢ã§ã™ã€‚</p>
    </div>

    <div class="demo-section">
        <h3>ğŸ’¡ æ”»æ’ƒã‚·ãƒŠãƒªã‚ª</h3>
        <ol>
            <li><strong>æ”»æ’ƒè€…ãŒæ‚ªæ„ã®ã‚ã‚‹ãƒšãƒ¼ã‚¸ã‚’ä½œæˆ</strong>
                <ul>
                    <li>é­…åŠ›çš„ãªã€Œç„¡æ–™ã‚®ãƒ•ãƒˆã€ãƒœã‚¿ãƒ³ã‚’è¡¨ç¤º</li>
                    <li>ãã®ä¸Šã«é€æ˜ãªiframeã§è„†å¼±ãªãƒšãƒ¼ã‚¸ã‚’é‡ã­ã‚‹</li>
                </ul>
            </li>
            <li><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã€Œç„¡æ–™ã‚®ãƒ•ãƒˆã€ã‚’ã‚¯ãƒªãƒƒã‚¯</strong>
                <ul>
                    <li>å®Ÿéš›ã«ã¯é€æ˜ãªiframeå†…ã®ã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                </ul>
            </li>
            <li><strong>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ°—ã¥ã‹ãšã«å±é™ºãªã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œ</strong></li>
        </ol>
    </div>

    <div class="demo-section">
        <h3>ğŸ”´ æ”»æ’ƒè€…ã®ãƒšãƒ¼ã‚¸ä¾‹</h3>
        <p>ä»¥ä¸‹ã¯ã€æ”»æ’ƒè€…ãŒä½œæˆã™ã‚‹æ‚ªæ„ã®ã‚ã‚‹ãƒšãƒ¼ã‚¸ã®ä¾‹ã§ã™ï¼š</p>
        
        <div style="border: 3px solid #dc3545; padding: 20px; background-color: #fff3cd; margin: 20px 0;">
            <iframe src="/clickjacking-attack-demo" width="100%" height="350" style="border: 2px solid #dc3545;"></iframe>
        </div>
        
        <p class="hint-text">
            âš ï¸ ä¸Šè¨˜ã®iframeå†…ã®ç·‘ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã™ã‚‹ã¨ã€å®Ÿéš›ã«ã¯é€æ˜ãª iframe å†…ã®ã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆå‰Šé™¤ã€ãƒœã‚¿ãƒ³ãŒã‚¯ãƒªãƒƒã‚¯ã•ã‚Œã¾ã™
        </p>
    </div>

    <div class="demo-section">
        <h3>ğŸ›¡ï¸ å¯¾ç­–æ–¹æ³•</h3>
        <div class="code-block">
            <p><strong>1. X-Frame-Options ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¨­å®š:</strong></p>
            <pre>X-Frame-Options: DENY</pre>
            <p>ã¾ãŸã¯ç‰¹å®šã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã¿è¨±å¯:</p>
            <pre>X-Frame-Options: SAMEORIGIN</pre>
            
            <p><strong>2. Content-Security-Policy (CSP) ã®è¨­å®š:</strong></p>
            <pre>Content-Security-Policy: frame-ancestors 'none';</pre>
            
            <p><strong>3. Flaskã§ã®å®Ÿè£…ä¾‹:</strong></p>
            <pre>@app.after_request
def add_security_headers(response):
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['Content-Security-Policy'] = "frame-ancestors 'none'"
    return response</pre>
        </div>
    </div>

    <div class="demo-section">
        <h3>ğŸ§ª ãƒ†ã‚¹ãƒˆæ–¹æ³•</h3>
        <p>é–‹ç™ºè€…ãƒ„ãƒ¼ãƒ«ã§ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š</p>
        <ul>
            <li><strong>Response Headers</strong> ã§ <code>X-Frame-Options</code> ãŒå­˜åœ¨ã—ãªã„ã“ã¨ã‚’ç¢ºèª</li>
            <li>ã“ã®ãƒšãƒ¼ã‚¸ã‚’åˆ¥ã®ãƒšãƒ¼ã‚¸ã§iframeå†…ã«åŸ‹ã‚è¾¼ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª</li>
            <li>æ”»æ’ƒè€…ã®ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸ã§ã€é€æ˜ãªiframeãŒæ­£ã—ãé‡ãªã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª</li>
        </ul>
    </div>

    <p><a href="/" class="btn">â† ãƒ›ãƒ¼ãƒ ã«æˆ»ã‚‹</a></p>
</div>

<style>
.vuln-demo {
    max-width: 900px;
    margin: 0 auto;
    padding: 20px;
}

.warning-box {
    background-color: #fff3cd;
    border-left: 5px solid #ffc107;
    padding: 20px;
    margin: 20px 0;
    border-radius: 5px;
}

.warning-box h3 {
    color: #856404;
    margin-top: 0;
}

.demo-section {
    background-color: #f8f9fa;
    padding: 25px;
    margin: 25px 0;
    border-radius: 8px;
    border: 1px solid #dee2e6;
}

.demo-section h3 {
    color: #495057;
    border-bottom: 2px solid #007bff;
    padding-bottom: 10px;
    margin-bottom: 20px;
}

.demo-section ol, .demo-section ul {
    line-height: 1.8;
}

.hint-text {
    color: #6c757d;
    font-style: italic;
    font-size: 14px;
    margin-top: 10px;
}

.code-block {
    background-color: #fff;
    border-left: 4px solid #dc3545;
    padding: 15px;
    margin: 15px 0;
}

.code-block pre {
    background-color: #f4f4f4;
    padding: 10px;
    border-radius: 4px;
    overflow-x: auto;
    font-family: monospace;
    font-size: 14px;
    margin: 10px 0;
}

.code-block p {
    margin: 10px 0 5px 0;
    font-weight: bold;
}

.btn {
    display: inline-block;
    padding: 10px 20px;
    background-color: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 5px;
    border: none;
    cursor: pointer;
    font-size: 16px;
}

.btn:hover {
    background-color: #0056b3;
}
</style>
{% endblock %}
