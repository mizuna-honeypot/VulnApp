{% extends "base.html" %}

{% block title %}Network Tools - Command Injection ãƒ‡ãƒ¢{% endblock %}

{% block content %}
<div class="vuln-demo">
    <h2>ğŸ”§ Network Tools (Command Injection ã®ãƒ‡ãƒ¢)</h2>
    
    <div class="warning-box">
        <h3>âš ï¸ è„†å¼±æ€§: Command Injection (A03:2021)</h3>
        <p>ã“ã‚Œã‚‰ã®ãƒ„ãƒ¼ãƒ«ã¯æ„å›³çš„ã«ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‚’å«ã‚“ã§ã„ã¾ã™ã€‚</p>
    </div>

    <div class="demo-section">
        <h3>ğŸ’¡ è©¦ã—ã¦ã¿ã‚‹ãƒšã‚¤ãƒ­ãƒ¼ãƒ‰</h3>
        <ul class="payload-list">
            <li><code>; ls -la</code> - ã‚³ãƒãƒ³ãƒ‰åŒºåˆ‡ã‚Šï¼ˆã‚»ãƒŸã‚³ãƒ­ãƒ³ï¼‰</li>
            <li><code>| whoami</code> - ãƒ‘ã‚¤ãƒ—ã§ã‚³ãƒãƒ³ãƒ‰å®Ÿè¡Œ</li>
            <li><code>& cat /etc/passwd</code> - ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ</li>
            <li><code>$(id)</code> - ã‚³ãƒãƒ³ãƒ‰ç½®æ›</li>
        </ul>
    </div>

    <div class="demo-section">
        <h3>ğŸ” Ping Tool</h3>
        <form method="POST" action="/tools/ping" class="tool-form">
            <div class="form-group">
                <label for="host">Host or IP Address:</label>
                <input type="text" id="host" name="host" value="{{ ping_host }}" placeholder="8.8.8.8">
            </div>
            <button type="submit" class="btn">Ping</button>
            <div class="example">è©¦ã—ã¦ã¿ã‚‹: <code>127.0.0.1; ls -la</code> ã¾ãŸã¯ <code>localhost | whoami</code></div>
        </form>
        {% if ping_output %}
        <div class="output-box">
            <h4>å®Ÿè¡Œçµæœ:</h4>
            <pre>{{ ping_output }}</pre>
        </div>
        {% endif %}
    </div>

    <div class="demo-section">
        <h3>ğŸŒ DNS Lookup</h3>
        <form method="POST" action="/tools/nslookup" class="tool-form">
            <div class="form-group">
                <label for="domain">Domain Name:</label>
                <input type="text" id="domain" name="domain" value="{{ nslookup_domain }}" placeholder="google.com">
            </div>
            <button type="submit" class="btn">Lookup</button>
            <div class="example">è©¦ã—ã¦ã¿ã‚‹: <code>google.com; cat /etc/passwd</code> ã¾ãŸã¯ <code>example.com & id</code></div>
        </form>
        {% if nslookup_output %}
        <div class="output-box">
            <h4>å®Ÿè¡Œçµæœ:</h4>
            <pre>{{ nslookup_output }}</pre>
        </div>
        {% endif %}
    </div>

    <div class="demo-section">
        <h3>ğŸ“– æŠ€è¡“çš„ãªèª¬æ˜</h3>
        <div class="code-block">
            <h4>è„†å¼±ãªã‚³ãƒ¼ãƒ‰:</h4>
            <pre>command = f"ping -c 4 {host}"
output = subprocess.check_output(command, shell=True)</pre>
            <p><code>shell=True</code>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã‚·ã‚§ãƒ«çµŒç”±ã§ã‚³ãƒãƒ³ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã€
               ç‰¹æ®Šæ–‡å­—(<code>;</code>, <code>|</code>, <code>&</code>ãªã©)ã‚’æ‚ªç”¨ã§ãã¾ã™ã€‚</p>
        </div>
        <div class="code-block">
            <h4>å®‰å…¨ãªã‚³ãƒ¼ãƒ‰:</h4>
            <pre>command = ["ping", "-c", "4", host]
output = subprocess.check_output(command, shell=False)</pre>
            <p><code>shell=False</code>ã‚’ä½¿ç”¨ã—ã€ã‚³ãƒãƒ³ãƒ‰ã‚’é…åˆ—ã§æŒ‡å®šã™ã‚‹ã“ã¨ã§ã€
               ã‚·ã‚§ãƒ«ã®ãƒ¡ã‚¿æ–‡å­—ãŒå‡¦ç†ã•ã‚Œãšã€ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ã‚’é˜²ã’ã¾ã™ã€‚</p>
        </div>
    </div>
</div>

<style>
.vuln-demo {
    max-width: 900px;
    margin: 0 auto;
}

.warning-box {
    background-color: #fff3cd;
    border: 2px solid #ffc107;
    border-radius: 5px;
    padding: 15px;
    margin: 20px 0;
}

.demo-section {
    background-color: #f8f9fa;
    border-radius: 5px;
    padding: 20px;
    margin: 20px 0;
}

.tool-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: 5px;
}

.form-group label {
    font-weight: bold;
    color: #333;
}

.form-group input[type="text"] {
    padding: 10px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 16px;
}

.example {
    font-size: 0.9em;
    color: #666;
    margin-top: 5px;
}

.example code {
    background-color: #f4f4f4;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: monospace;
}

.payload-list {
    list-style: none;
    padding: 0;
}

.payload-list li {
    background-color: #fff;
    border-left: 4px solid #007bff;
    padding: 10px;
    margin: 10px 0;
    font-family: monospace;
}

.payload-list code {
    background-color: #f4f4f4;
    padding: 2px 6px;
    border-radius: 3px;
    font-size: 14px;
}

.output-box {
    margin-top: 20px;
    background-color: #000;
    border-radius: 5px;
    padding: 15px;
}

.output-box h4 {
    color: #0f0;
    margin-top: 0;
}

.output-box pre {
    color: #0f0;
    font-family: 'Courier New', monospace;
    white-space: pre-wrap;
    word-wrap: break-word;
    max-height: 300px;
    overflow-y: auto;
    margin: 0;
}

.code-block {
    background-color: #fff;
    border-left: 4px solid #28a745;
    padding: 15px;
    margin: 15px 0;
}

.code-block pre {
    background-color: #f4f4f4;
    padding: 10px;
    border-radius: 4px;
    overflow-x: auto;
    font-family: monospace;
    font-size: 14px;
    margin: 10px 0;
}

.code-block code {
    background-color: #f4f4f4;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: monospace;
}
</style>
{% endblock %}
