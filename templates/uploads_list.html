{% extends "base.html" %}

{% block title %}Uploads ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª - Directory Listing ãƒ‡ãƒ¢{% endblock %}

{% block content %}
<div class="vuln-demo">
    <h2>ğŸ“‚ Uploads ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª (Directory Listing ã®ãƒ‡ãƒ¢)</h2>
    
    <div class="warning-box">
        <h3>âš ï¸ è„†å¼±æ€§: Directory Listing (A05:2021)</h3>
        <p>ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯æ„å›³çš„ã«ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹è¨­å®šã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
        <p>æœ¬æ¥éå…¬é–‹ã§ã‚ã‚‹ã¹ããƒ•ã‚¡ã‚¤ãƒ«ãŒé–²è¦§å¯èƒ½ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚</p>
    </div>

    <div class="demo-section">
        <h3>ğŸ“ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å†…å®¹</h3>
        
        {% if files %}
        <div class="directory-listing">
            <table>
                <thead>
                    <tr>
                        <th>ãƒ•ã‚¡ã‚¤ãƒ«å</th>
                        <th>ã‚µã‚¤ã‚º</th>
                        <th>æ›´æ–°æ—¥æ™‚</th>
                        <th>ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="parent-dir">
                        <td><a href="/">ğŸ“ [è¦ªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª]</a></td>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    {% for file in files %}
                    <tr>
                        <td>
                            <span class="file-icon">ğŸ“„</span>
                            <strong>{{ file.name }}</strong>
                        </td>
                        <td>{{ file.size }} bytes</td>
                        <td>{{ file.mtime }}</td>
                        <td>
                            <a href="/uploads/{{ file.name }}" class="btn-small">ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="info-box">
            <p>ã“ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã¯ç©ºã§ã™ã€‚</p>
        </div>
        {% endif %}
    </div>

    <div class="demo-section">
        <h3>ğŸ’¡ ã“ã®è„†å¼±æ€§ã«ã¤ã„ã¦</h3>
        <ul class="info-list">
            <li>Webã‚µãƒ¼ãƒãƒ¼ã®è¨­å®šãƒŸã‚¹ã«ã‚ˆã‚Šã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å†…å®¹ãŒä¸€è¦§è¡¨ç¤ºã•ã‚Œã‚‹</li>
            <li>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ãƒ•ã‚¡ã‚¤ãƒ«ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã€æ©Ÿå¯†æƒ…å ±ãŒæ¼æ´©ã™ã‚‹å¯èƒ½æ€§</li>
            <li>æ”»æ’ƒè€…ãŒã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã‚’æŠŠæ¡ã™ã‚‹æ‰‹ãŒã‹ã‚Šã«ãªã‚‹</li>
            <li>ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚¢ã‚¯ã‚»ã‚¹ã™ã¹ãã§ãªã„ãƒ•ã‚¡ã‚¤ãƒ«ãŒéœ²å‡ºã™ã‚‹</li>
        </ul>
    </div>

    <div class="demo-section">
        <h3>ğŸ“– å¯¾ç­–æ–¹æ³•</h3>
        <div class="code-block">
            <h4>Apacheã®å ´åˆ:</h4>
            <pre># .htaccess ã¾ãŸã¯ httpd.conf
Options -Indexes

# ã¾ãŸã¯
&lt;Directory /var/www/html/uploads&gt;
    Options -Indexes
&lt;/Directory&gt;</pre>
        </div>
        <div class="code-block">
            <h4>Nginxã®å ´åˆ:</h4>
            <pre>location /uploads/ {
    autoindex off;  # ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸€è¦§ã‚’ç„¡åŠ¹åŒ–
}</pre>
        </div>
        <div class="code-block">
            <h4>Flaskã®å ´åˆ:</h4>
            <pre># ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä¸€è¦§ç”¨ã®ãƒ«ãƒ¼ãƒˆã‚’å‰Šé™¤
# @app.route('/uploads/') ã‚’å®Ÿè£…ã—ãªã„
# å€‹åˆ¥ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã®ã¿è¨±å¯</pre>
        </div>
    </div>
</div>

<style>
.vuln-demo {
    max-width: 1000px;
    margin: 0 auto;
}

.warning-box {
    background-color: #fff3cd;
    border: 2px solid #ffc107;
    border-radius: 5px;
    padding: 15px;
    margin: 20px 0;
}

.demo-section {
    background-color: #f8f9fa;
    border-radius: 5px;
    padding: 20px;
    margin: 20px 0;
}

.directory-listing {
    background-color: #fff;
    border-radius: 5px;
    overflow-x: auto;
}

.directory-listing table {
    width: 100%;
    border-collapse: collapse;
}

.directory-listing th {
    background-color: #e9ecef;
    padding: 12px;
    text-align: left;
    font-weight: bold;
    border-bottom: 2px solid #dee2e6;
}

.directory-listing td {
    padding: 10px 12px;
    border-bottom: 1px solid #dee2e6;
}

.directory-listing tr:hover {
    background-color: #f8f9fa;
}

.parent-dir td {
    background-color: #f1f3f5;
}

.file-icon {
    margin-right: 8px;
    font-size: 1.2em;
}

.btn-small {
    display: inline-block;
    padding: 5px 12px;
    background-color: #007bff;
    color: white;
    text-decoration: none;
    border-radius: 4px;
    font-size: 14px;
}

.btn-small:hover {
    background-color: #0056b3;
}

.info-box {
    background-color: #d1ecf1;
    border: 1px solid #bee5eb;
    border-radius: 5px;
    padding: 15px;
    color: #0c5460;
}

.info-list {
    list-style: none;
    padding: 0;
}

.info-list li {
    background-color: #fff;
    border-left: 4px solid #007bff;
    padding: 10px;
    margin: 10px 0;
}

.code-block {
    background-color: #fff;
    border-left: 4px solid #28a745;
    padding: 15px;
    margin: 15px 0;
}

.code-block h4 {
    margin-top: 0;
    color: #28a745;
}

.code-block pre {
    background-color: #f4f4f4;
    padding: 10px;
    border-radius: 4px;
    overflow-x: auto;
    font-family: monospace;
    font-size: 14px;
}
</style>
{% endblock %}
